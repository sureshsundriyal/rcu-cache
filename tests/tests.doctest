    >>> from rcu import *

Initialize an RCUCache.
    >>> x = RCUCache()

Make sure that the RCU algorithm is working for addition.
    >>> pre_address = id(x.items)
    >>> x[1] = 2
    >>> post_address = id(x.items)
    >>> pre_address != post_address
    True
    >>> x[2] = 3
    >>> x
    RCUCache(size=None, items=OrderedDict([(1, 2), (2, 3)]))
    >>> x[2]
    3

Make sure deletion of elements works fine.
    >>> del x[2]
    >>> x
    RCUCache(size=None, items=OrderedDict([(1, 2)]))

Make sure copy works fine.
    >>> y = x.copy()
    >>> y
    RCUCache(size=None, items=OrderedDict([(1, 2)]))

Make sure we can pickle/unpickle the objects.
    >>> import pickle
    >>> z = pickle.dumps(y)
    >>> pickle.loads(z)
    RCUCache(size=None, items=OrderedDict([(1, 2)]))

Update the object.
    >>> y.update({ 1:4, 5:6 })
    >>> y
    RCUCache(size=None, items=OrderedDict([(1, 4), (5, 6)]))

Initialize an RCUCache object with initial objects.
    >>> x = RCUCache(items={ 1:2, 2:3 })
    >>> x
    RCUCache(size=None, items=OrderedDict([(1, 2), (2, 3)]))

Clear out all the items and make sure the RCU algorithm is working.
    >>> pre_address = id(x.items)
    >>> x.clear()
    >>> post_address = id(x.items)
    >>> pre_address != post_address
    True
    >>> len(x.items)
    0

Make sure that the object is immutable and cannot be extended.
    >>> x.foo = 'foo'
    Traceback (most recent call last):
    ...
    TypeError: RCUCache is immutable

Make sure that the tests for membership is disabled.
    >>> x[1] = 2
    >>> 1 in x #doctest:+IGNORE_EXCEPTION_DETAIL
    Traceback (most recent call last):
    ...
    TypeError

Test pop().
    >>> pre_address = id(x.items)
    >>> x.pop(1)
    2
    >>> post_address = id(x.items)
    >>> pre_address != post_address
    True

Test popitem().
    >>> x[1] = 2
    >>> x[2] = 3
    >>> pre_address = id(x.items)
    >>> x.popitem(last=False)
    (1, 2)
    >>> post_address = id(x.items)
    >>> pre_address != post_address
    True
    >>> x[1] = 2
    >>> x.popitem()
    (1, 2)

Test the RCU eviction.
    >>> x = RCUCache(size=2)
    >>> x[2] = 1
    >>> x[3] = 4
    >>> x
    RCUCache(size=2, items=OrderedDict([(2, 1), (3, 4)]))

Now add another element and make sure one of them gets evicted.
    >>> x[5] = 6
    >>> x
    RCUCache(size=2, items=OrderedDict([(3, 4), (5, 6)]))

Update with more elements than possible in the list.
    >>> from collections import OrderedDict
    >>> y = OrderedDict()
    >>> y[1] = 4
    >>> y[5] = 6
    >>> y[7] = 8
    >>> y[9] = 10
    >>> x.update(y)
    >>> x
    RCUCache(size=2, items=OrderedDict([(7, 8), (9, 10)]))

Check for size of the object.
    >>> len(x)
    2
